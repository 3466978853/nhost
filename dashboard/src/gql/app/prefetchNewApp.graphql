fragment PrefetchNewAppRegions on regions {
  id
  city
  active
  country {
    code
    name
  }
}

fragment PrefetchNewAppPlans on plans {
  id
  name
  isDefault
  isFree
  price
  featureBackupEnabled
  featureCustomDomainsEnabled
  featureMaxDbSize
}

fragment PrefetchNewAppWorkspace on workspaces {
  id
  name
  slug
  paymentMethods {
    id
  }
}

query PrefetchNewApp($userId: uuid!) {
  regions(order_by: { city: asc }) {
    ...PrefetchNewAppRegions
  }
  plans(order_by: { sort: asc }) {
    ...PrefetchNewAppPlans
  }
  workspaces {
    ...PrefetchNewAppWorkspace
  }
  apps(
    where: { creatorUserId: { _eq: $userId }, plan: { isFree: { _eq: true } } }
  ) {
    id
  }
}
